!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueTextUtils={})}(this,function(e){"use strict";var t=Object.defineProperty,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(e,n,i)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,a=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(n)for(var a of n(t))o.call(t,a)&&r(e,a,t[a]);return e};const u=new WeakMap,l=new WeakMap;function c(e){const t=new WeakMap,n=new WeakMap,i=(i,o)=>{const r=i.textContent||"";u.set(i,r),n.set(i,o),t.get(i)||(t.set(i,!0),queueMicrotask(()=>{t.delete(i);const r=n.get(i)||o;e(i,r)}))};return{mounted:(e,t)=>{if(void 0===t.value||null===t.value){O().debug&&console.warn('[VueTextUtils] Implicit mode detected. Note: Implicit mode with {{ }} interpolation does NOT support reactivity. For reactive data, use explicit mode instead: v-currency="yourValue" instead of v-currency>{{ yourValue }}')}i(e,t)},updated:i,unmounted:e=>{const t=l.get(e);t&&(t.disconnect(),l.delete(e))}}}function s(e){var t;const n=O(),i=e.instance;return(null==(t=null==i?void 0:i.$i18n)?void 0:t.locale)||n.locale||"en-US"}function d(e,t){const{value:r}=e;if(null==r)return{mode:"implicit",value:void 0,options:a({},t)};if(!("object"!=typeof r||null===r||Array.isArray(r)||r instanceof Date)){if("value"in r&&void 0!==r.value){const e=r,{value:u}=e,l=((e,t)=>{var r={};for(var a in e)i.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&n)for(var a of n(e))t.indexOf(a)<0&&o.call(e,a)&&(r[a]=e[a]);return r})(e,["value"]);return{mode:"explicit",value:u,options:a(a({},t),l)}}return{mode:"options",value:void 0,options:a(a({},t),r)}}return{mode:"explicit",value:r,options:a({},t)}}function m(e,t=""){const n=u.get(e),i=void 0!==n?n:e.textContent||"",o=e.getAttribute("data-raw-value");if(null!==o){if(i.trim()===o.trim())return o;const t=i.replace(/^\s+|\s+$/g,""),n=/^-?\d+(\.\d+)?$/.test(t),r=o.replace(/^\s+|\s+$/g,""),a=/^-?\d+(\.\d+)?$/.test(r);return n&&a&&t!==r||n&&!a?(e.setAttribute("data-raw-value",i.trim()),i.trim()):o}const r=i.trim();return r&&e.setAttribute("data-raw-value",r),r||e.getAttribute("data-value")||t}function f(e,t,n,i,o={},r){e.textContent=n,void 0!==r&&e.setAttribute("data-raw-value",String(r)),t.accessibility&&(e.setAttribute("aria-label",`${i}: ${n}`),Object.entries(o).forEach(([t,n])=>{e.setAttribute(t,n)})),t.class&&e.classList.add(t.class)}function p(e,t,n){t instanceof Error?console.error(`${e} directive formatting error:`,t):console.warn(`${e} directive: Invalid value:`,n)}function y(e,t){const n=parseFloat(String(e));return isNaN(n)?(console.warn(`${t} directive: Invalid numeric value:`,e),null):n}function v(e,t){if(e instanceof Date)return e;if("string"==typeof e||"number"==typeof e){const n=new Date(e);return isNaN(n.getTime())?(console.warn(`${t} directive: Invalid date value:`,e),null):n}return console.warn(`${t} directive: Invalid date value:`,e),null}const g=c(function(e,t){const{arg:n}=t,i=O(),o=s(t),r={currency:n||i.defaultCurrency||"USD",currencyDisplay:"symbol",minimumFractionDigits:2,maximumFractionDigits:2,accessibility:!0,locale:o},{mode:a,value:u,options:l}=d(t,r);"options"===a&&n&&(l.currency=n);let c,v;"implicit"===a||"options"===a?(v=m(e,"0"),c=y(v,"Currency")):(v=u,c=y(v,"Currency"));if(null===c)return;try{const t=new Intl.NumberFormat(l.locale,{style:"currency",currency:l.currency,currencyDisplay:l.currencyDisplay,minimumFractionDigits:l.minimumFractionDigits,maximumFractionDigits:l.maximumFractionDigits});f(e,l,t.format(c),"Currency",{"data-currency-value":c.toString(),"data-currency-code":l.currency||"USD"},v)}catch(g){p("Currency",g,u)}});const U=c(function(e,t){const n={minimumFractionDigits:void 0,maximumFractionDigits:void 0,useGrouping:!0,percentage:!1,accessibility:!0,locale:s(t)},{mode:i,value:o,options:r}=d(t,n);let a,u;"implicit"===i||"options"===i?(u=m(e,"0"),a=y(u,"Number")):(u=o,a=y(u,"Number"));if(null===a)return;try{const t={useGrouping:r.useGrouping,minimumFractionDigits:r.minimumFractionDigits,maximumFractionDigits:r.maximumFractionDigits},n=new Intl.NumberFormat(r.locale,t);let i;i=r.percentage?n.format(100*a)+"%":n.format(a),f(e,r,i,"Number",{"data-number-value":a.toString()},u)}catch(l){p("Number",l,o)}});const D=c(function(e,t){const n=O(),i=s(t),o={dateStyle:"medium",timeStyle:"short",timeZone:n.defaultTimezone||"UTC",accessibility:!0,locale:i,inputFormat:"auto"},{mode:r,value:a,options:u}=d(t,o);let l,c;"implicit"===r||"options"===r?(c=m(e,""),l=v(c,"DateTime")):(c=a,l=v(c,"DateTime"));if(null===l)return;try{const t={};u.dateStyle&&"none"!==u.dateStyle&&(t.dateStyle=u.dateStyle),u.timeStyle&&"none"!==u.timeStyle&&(t.timeStyle=u.timeStyle),u.timeZone&&(t.timeZone=u.timeZone);const n=new Intl.DateTimeFormat(u.locale,t);f(e,u,n.format(l),"Date",{"data-date-value":l.toISOString(),"data-timezone":u.timeZone||"UTC"},c)}catch(y){p("DateTime",y,a)}});function b(){try{if("undefined"!=typeof navigator&&navigator.language)return navigator.language;if("undefined"!=typeof Intl){const e=(new Intl.DateTimeFormat).resolvedOptions().locale;if(e)return e}return"en-US"}catch(e){return console.warn("Could not detect user locale:",e),"en-US"}}function T(){try{if("undefined"!=typeof Intl){const e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e)return e}return"UTC"}catch(e){return console.warn("Could not detect user timezone:",e),"UTC"}}function S(e){try{const t=e||b();if("undefined"!=typeof Intl){const e=new Intl.NumberFormat(t,{style:"currency",currency:R(t)}).resolvedOptions();if(e.currency)return e.currency}return"USD"}catch(t){return console.warn("Could not detect user currency:",t),"USD"}}function R(e){const t={"en-US":"USD","en-GB":"GBP","en-CA":"CAD","en-AU":"AUD","en-NZ":"NZD","de-DE":"EUR","fr-FR":"EUR","es-ES":"EUR","it-IT":"EUR","nl-NL":"EUR","pt-PT":"EUR","el-GR":"EUR","fi-FI":"EUR","at-AT":"EUR","be-BE":"EUR","ie-IE":"EUR","lu-LU":"EUR","mt-MT":"EUR","sk-SK":"EUR","si-SI":"EUR","ee-EE":"EUR","lv-LV":"EUR","lt-LT":"EUR","ja-JP":"JPY","ko-KR":"KRW","zh-CN":"CNY","zh-TW":"TWD","zh-HK":"HKD","th-TH":"THB","vi-VN":"VND","id-ID":"IDR","my-MY":"MYR","sg-SG":"SGD","ph-PH":"PHP","in-IN":"INR","es-MX":"MXN","pt-BR":"BRL","es-AR":"ARS","es-CL":"CLP","es-CO":"COP","es-PE":"PEN","es-US":"USD","ca-CA":"CAD","en-JM":"JMD","en-BB":"BBD","en-TT":"TTD","ru-RU":"RUB","pl-PL":"PLN","tr-TR":"TRY","he-IL":"ILS","ar-SA":"SAR","ar-AE":"AED","no-NO":"NOK","sv-SE":"SEK","da-DK":"DKK","cs-CZ":"CZK","hu-HU":"HUF","ro-RO":"RON","bg-BG":"BGN","hr-HR":"HRK","uk-UA":"UAH"};if(t[e])return t[e];const n=e.split("-")[0],i=Object.keys(t).find(e=>e.startsWith(n+"-"));return i?t[i]:"USD"}function C(){const e=b();return{locale:e,timezone:T(),currency:S(e)}}const E={currency:g,number:U,"date-time":D};let I={locale:"en-US",defaultCurrency:"USD",defaultTimezone:"UTC",autoDetect:!0,debug:!1};const O=()=>I,N=e=>{const t=a({},I);I=a(a({},I),e),I.debug&&console.log("VueTextUtils options updated:",{previous:t,new:I,changes:e})},w=()=>{const e=C();I={locale:(null==e?void 0:e.locale)||"en-US",defaultCurrency:(null==e?void 0:e.currency)||"USD",defaultTimezone:(null==e?void 0:e.timezone)||"UTC",autoDetect:!0,debug:!1},I.debug&&console.log("VueTextUtils options reset to auto-detected:",I)},F={install(e,t={}){var n,i;const o=!1!==t.autoDetect?C():null;I={locale:t.locale||(null==o?void 0:o.locale)||"en-US",defaultCurrency:t.defaultCurrency||(null==o?void 0:o.currency)||"USD",defaultTimezone:t.defaultTimezone||(null==o?void 0:o.timezone)||"UTC",autoDetect:null==(n=t.autoDetect)||n,debug:null!=(i=t.debug)&&i},I.debug&&(console.log("VueTextUtils initialized with options:",I),o&&console.log("Auto-detected user preferences:",o)),e.provide("vueTextUtilsOptions",I),e.provide("updateVueTextUtilsOptions",N),e.provide("resetVueTextUtilsOptions",w),e.config.globalProperties.$vueTextUtils={getOptions:O,updateOptions:N,resetOptions:w},Object.entries(E).forEach(([t,n])=>{e.directive(t,n),e.directive(`format.${t}`,n)})}};e.CurrencyDirective=g,e.DateTimeDirective=D,e.NumberDirective=U,e.VueTextUtils=F,e.detectUserCurrency=S,e.detectUserLocale=b,e.detectUserPreferences=C,e.detectUserTimezone=T,e.formatDirectives=E,e.getGlobalOptions=O,e.hasBrowserSupport=function(){return{intl:"undefined"!=typeof Intl,dateTimeFormat:"undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat,numberFormat:"undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat,navigator:"undefined"!=typeof navigator&&"string"==typeof navigator.language}},e.resetGlobalOptions=w,e.updateGlobalOptions=N,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=index.umd.js.map
